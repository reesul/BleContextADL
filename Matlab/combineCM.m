%combine confusion matrices

%% Using greedy method
%using test set, context features included
CMclass = [0   1   0   0   0   0   0   0   0;   0 313   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =  [0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 ;0 0 0 0 0 9 0 0 0;0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0];
CMclass_walking = [0  0  0  0  0  0  0  0  0  ;0 37  0  0  0  0  0  0  0;0 0  0  0  0  0  0  0  0 ;0  0  0  0  0  0  0  0  0;0  0  0  0  0  0  0  0  0;0  0  0  0  0  0  0  0  0;0  0  0  0  0  0  0  0  0;0  0  0  0  0  0  0  0  0;0  0  0  0  0  0  0  0  2];
CMcooking_schoolwork = [0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  39   0   0   0   0   2   0;   0   0   2   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0 393   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  27 562   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [27  3  0  0  0  0  4  0  2;  2 27  0  1  0  4  3  0  1;  0  0  0  0  0  0  0  0  0;  1  1  0  6  0  0  6  0  1;  0  0  0  0  5  0  0  0  0;  0 16  0  3  0  1  7  0  0;  1  1  0  1  0  0 13  0  1;  0  0  0  0  0  0  0  0  0;  0  5  0  1  0  0  0  0  9];
CMtotalContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextGreedy)
contextGreedyResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


% test set, context features omitted
CMclass = [   0   1   0   0   0   0   0   0   0;   0 313   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =  [0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 3 0 0 0 6 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking =   [0  0  0  0  0  0  0  0  0;  0 37  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  2];
CMcooking_schoolwork = [0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  24   0   0   0   0  17   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   5   0   0   0   0 405   0;   0   0   0   0   0   0   0   0   0];
CMdriving =  [0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  27 562   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 27  4  0  0  0  0  4  0  1;  0 19  0  1  1  0 13  4  0;  0  0  0  0  0  0  0  0  0;  1  2  0  6  2  0  1  0  3;  0  0  0  0  4  0  1  0  0;  1  2  0  1  0 20  3  0  0;  0  1  0  0  0  3 13  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  1  0  0  0 12];
CMtotalNoContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF] = cmStats(CMtotalNoContextGreedy)
noContextGreedyResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};

%% Hierarchical clustering method
%using context features
CMclass = [   0   0   0   0   0   0   0   0   0;   0 263   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [  0  1  0  0  0  0  0  0  0;  0 11  0  0  0  2  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  3  0  0  0  6  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
CMclass_walking = [  0  0  0  0  0  0  0  0  0;  0 19  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
CMcooking_schoolwork = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   2   0   0   0   0  39   0;   0   0   0   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   5   0   0   0   0 379   0;   0   0   0   0   0   0   0   0   0];
CMexercising =[   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting_research = [   0   0   0   0   0   0   4   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  34 552   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 18  7  0  6  0  1  4  0  1;  5 65  0  6  5  6  6  0  0;  0  0  0  0  0  0  0  0  0;  2  8  0  9  2  0  3  1  0;  0  1  0  0  4  0  0  0  0;  0 17  0  1  1 13  2  0  0;  0  4  0  0  0  1 12  0  0;  0  0  0  0  0  0  0 26  0;  0  7  0  1  0  0  2  0  5];
CMresearch = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 3 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMtotalContextHAC = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMexercising+CMmeeting_research+CMnull+CMresearch
[acc_CF, wacc_CF, acc_per_CF, f1_CF, wf1_CF, f1_per_CF] = cmStats(CMtotalContextHAC)
noContextHACResults = {acc_CF, wacc_CF, acc_per_CF, f1_CF, wf1_CF, f1_per_CF};

%using no context features; only IMU and statistical BLE
CMclass = [   0   0   0   0   0   0   0   0   0;   0 263   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [  0  1  0  0  0  0  0  0  0;  0 12  0  0  0  1  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  7  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
CMclass_walking = [  0  0  0  0  0  0  0  0  0;  0 19  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
CMcooking_schoolwork =  [  0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   0   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  11   0   0   0   0 373   0;   0   0   0   0   0   0   0   0   0];
CMexercising = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting_research = [   0   0   0   0   0   1   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  35 551   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 19  3  0  6  0  1  4  0  4;  3 49  1  0 10  4 18  4  4;  0  0  0  0  0  0  0  0  0;  4  4  0  9  3  0  3  0  2;  0  2  0  0  2  0  1  0  0;  0  1  0  0  0 22 11  0  0;  2  4  0  0  2  3  6  0  0;  0  6  0  0  0  0  9 11  0;  1  2  0  1  0  0  1  0 10];
CMresearch = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 3 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMtotalContextHAC = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMexercising+CMmeeting_research+CMnull+CMresearch
[acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF] = cmStats(CMtotalContextHAC)
noContextHACResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


%% confusion matrices for single-beacon patterns (i.e. no joining, only lower threshold)
%using context features
CMclass = [   0   1   0   0   0   0   0   0   0;   0 321   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [  0  2  0  0  0  0  0  0  0;  0 19  0  0  0  0  0  0  3;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  1];
CMcooking_schoolwork =  [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   2   0   0   0   0  39   0;   0   0   0   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   5   0   0   0   0 405   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 3 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  31 559   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 14  8  0  5  2  0  5  0  2;  1 30  0  0  3  9  1  0  0;  0  0  0  0  0  0  0  0  0;  1  2  0  4  2  3  4  0  0;  0  0  0  1  4  0  0  0  0;  0  1  0  1  4 23  2  0  0;  0  1  0  1  0  1 12  0  1;  0  0  0  0  0  0  0  0  0;  0  3  0  1  0  0  0  0 10];
CMtotalContextSingle = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull
[acc_CF, wacc_CF, acc_per_CF, f1_CF, wf1_CF, f1_per_CF] = cmStats(CMtotalContextSingle)
ContextSingleResults = {acc_CF, wacc_CF, acc_per_CF, f1_CF, wf1_CF, f1_per_CF};

% without context features
CMclass = [   0   1   0   0   0   0   0   0   0;   0 321   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [  0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [   0  2  0  0  0  0  0  0  0;  0 22  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  1];
CMcooking_schoolwork =  [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   1   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  11   0   0   0   0 399   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [    0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 3 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   1   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  36 554   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [  18  2  0  6  0  1  5  0  4;  2 24  0  0  5  2  7  1  3;  0  0  0  0  0  0  0  0  0;  1  2  0  6  3  0  2  0  2;  0  2  0  0  2  0  1  0  0;  0  0  0  0  0 21 10  0  0;  2  3  0  0  2  3  6  0  0;  0  0  0  0  0  0  0  0  0;  1  1  0  1  0  0  1  0 10];
CMtotalContextSingle = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull
[acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF] = cmStats(CMtotalContextSingle)
SingleBeaconResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


%% Greedy second attempt
%using test set, context features included
CMclass = [   0   1   0   0   0   0   0   0   0;   0 282   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   2   0   0   0   0   0   0   0];
CMclass_meeting =  [ 0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 3 0 0 0 6 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [  0  2  0  0  0  0  0  0  0;  0 68  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  0  0  0  0];
CMcooking_schoolwork = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0  24   0;   0   0   0   0   0   0   0   5   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  12   0   0   0   0 398   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 9 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 4 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  31 558   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 17  2  0  8  0  0  3  0  4;  3 26  0  3  0  3  3  0  0;  0  0  0  0  0  0  0  0  0;  2  1  0  4  0  0  6  0  1;  0  1  0  0  4  0  0  0  0;  0  1  0  2  0 16 11  0  0;  0  0  0  2  0  2 10  0  3;  0  0  0  0  0  0  0  0  0;  0  2  0  2  0  0  0  0  9];
CMtotalContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextGreedy)
contextGreedyResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


% test set, context features omitted
CMclass = [    0   1   0   0   0   0   0   0   0;   0 282   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   2   0   0   0   0   0   0   0];
CMclass_meeting =  [ 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking =   [  0  1  0  0  0  0  0  0  1;  0 67  0  0  0  0  0  0  1;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  1];
CMcooking_schoolwork = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  11   0   0   0   0 399   0;   0   0   0   0   0   0   0   0   0];
CMdriving =  [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 9 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [     0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 4 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  36 553   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 17  3  0  6  0  1  4  0  3;  1 20  1  0  3  0 11  1  1;  0  0  0  0  0  0  0  0  0;  1  2  0  5  2  0  3  0  0;  0  2  0  0  2  0  1  0  0;  0  0  0  0  0 21  9  0  0;  2  4  0  0  2  3  6  0  0;  0  0  0  0  0  0  0  0  0;  1  0  0  1  0  0  1  0 10];
CMtotalNoContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF] = cmStats(CMtotalNoContextGreedy)
noContextGreedyResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


%% FIXING IMU FEATURES TO RESET BINNING

%% Greedy approach; updated patterns
CMclass = [    0   1   0   0   0   0   0   0   0;   0 333   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =  [  0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 8 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [   0  0  0  0  0  0  0  0  0;  0 17  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
CMcooking_schoolwork = [    0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  27   0   0   0   0  14   0;   0   0   2   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   7   0   0   0   0 403   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 7 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [     0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  33 556   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [  18  1  0  8  0  0  4  0  5;  2 30  0  3  0  0  3  0  0;  0  0  0  0  0  0  0  0  0;  1  1  0  5  1  0  7  0  1;  0  0  0  1  4  0  0  0  0;  0  7  0  6  0  2 12  0  0;  0  3  0  1  0  0 11  0  2;  0  0  0  0  0  0  0  0  0;  0  4  0  2  0  0  0  0  7];

CMtotalContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextGreedy)
contextGreedyResults = {acc, wacc, acc_per, f1, wf1, f1_per};


% test set, context features omitted
CMclass = [    0   1   0   0   0   0   0   0   0;   0 333   0   0   0   0   0   0   0;  0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =  [  0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking =   [    0  0  0  0  0  0  0  0  0;  0 17  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  1];
CMcooking_schoolwork = [    0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  20   0   0   0   0  21   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  13   0   0   0   0 397   0;   0   0   0   0   0   0   0   0   0];
CMdriving =  [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 7 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  34 555   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [  18  5  0  6  0  1  3  0  3;  1 21  1  0  3  0 10  1  1;  0  0  0  0  0  0  0  0  0;  2  3  0  5  3  0  3  0  0;  0  2  0  0  2  0  1  0  0;  0  0  0  0  0 20  7  0  0;  2  5  0  0  2  2  6  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  1  0  0  1  0 10];

CMtotalNoContextGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF] = cmStats(CMtotalNoContextGreedy)
noContextGreedyResults = {acc_NoCF, wacc_NoCF, acc_per_NoCF, f1_NoCF, wf1_NoCF, f1_per_NoCF};


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Attempts 2-9, fixed BLE and FFT features. No longer using context features
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Greedy
CMbiking =[  7 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 2 0 0 0 0 0 0 0 0];
CMbiking_class =[  0  0  0  0  0  0  0  0  0;  0 20  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  0  0  0  0];
CMbiking_research =[ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 8 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass =[   0   1   0   0   0   0   0   0   0;   0 319   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =[ 0 1 0 0 0 0 0 0 0; 0 2 0 0 0 2 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking =[  0  0  0  0  0  0  0  0  0;  0 30  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
CMcooking_schoolwork =[   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  12   0   0   0   0 398   0;   0   0   0   0   0   0   0   0   0];
CMdriving =[ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 7 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMdriving_exercising =[ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 1 4 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising =[   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting =[ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research =[   0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   6   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  35 554   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull =[ 15  3  0  4  1  0  4  0  2;  0  2  0  0  2  0  5  0  0;  0  0  0  0  0  0  0  0  0;  1  1  0  6  2  2  4  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0 18  9  0  0;  1  2  0  0  1  2  2  0  0;  0  0  0  0  0  0  0  0  0;  1  0  0  1  0  0  0  0  7];

CMtotalGreedy = CMbiking+CMbiking_class+CMbiking_research+CMclass+CMclass_meeting+CMclass_walking ...
    +CMcooking_schoolwork+CMdriving+CMdriving_exercising+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalGreedy)
greedyResults = {acc, wacc, acc_per, f1, wf1, f1_per};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Attempts 2-11, added a BLE feature
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Greedy
CMclass = [   0   1   0   0   0   0   0   0   0;   0 313   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   3   0   0   0   0   0   0   0];
CMclass_meeting =  [ 0 0 0 0 0 1 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking =   [  0  0  0  0  0  0  0  0  0;  0 37  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  2];
CMcooking_schoolwork = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
CMdriving =  [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   1   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   0   3   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 568   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 27  3  0  0  0  2  3  0  1;  0 21  0  1  0  0 12  4  0;  0  0  0  0  0  0  0  0  0;  1  0  0  9  1  0  1  0  3;  0  0  0  0  3  0  2  0  0;  1  1  0  1  0 19  4  1  0;  0  3  0  0  0  2 12  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  1  1  0  0  0 12];

CMtotalGreedy = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalGreedy)
GreedyResults = {acc, wacc, acc_per, f1, wf1, f1_per};

%% Single Beacon Patterns
CMclass = [   0   1   0   0   0   0   0   0   0;   0 321   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [ 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [  0  2  0  0  0  0  0  0  0;  0 20  0  0  0  0  0  0  2;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  1];
CMcooking_schoolwork =  [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 3 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   1   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 569   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 27  4  0  0  0  2  3  0  0;  0 27  0  1  3  0 10  3  0;  0  0  0  0  0  0  0  0  0;  1  0  0  9  2  0  1  0  3;  0  0  0  0  3  0  2  0  0;  1  2  0  1  0 21  4  1  1;  0  3  0  0  0  2 11  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  1  1  0  0  0 13];

CMtotalContextSingle = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextSingle)
SingleBeaconResults = {acc, wacc, acc_per, f1, wf1, f1_per};

%% HAC-based patterns
%using no context features; only IMU and statistical BLE
CMclass = [   0   1   0   0   0   0   0   0   0;   0 295   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [ 0 0 0 0 0 0 0 0 0; 0 9 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 7 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [  0  2  0  0  0  0  0  0  0;  0 17  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  1];
CMcooking_schoolwork =  [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   2   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 378   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 3 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [    0   0   0   0   0   1   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 568   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [ 27  4  0  0  0  2  3  0  0;  0 34  0  3  8  0 10  4  1;  0  0  0  0  0  0  0  0  0;  1  1  0  9  2  0  1  0  3;  0  0  0  0  3  0  2  0  0;  1  2  0  1  0 21  4  1  1;  0  3  0  0  0  2 12  0  0;  0  6  0  0  0  0  4 16  0;  0  3  0  1  1  0  0  0 13];

CMtotalContextHAC = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork ...
 +CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextHAC)
noContextHACResults = {acc, wacc, acc_per, f1, wf1, f1_per};


%% Single patterns, no BLE statistical features
CMclass = [     0   1   0   0   0   0   0   0   0 ;   0 321   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
CMclass_meeting = [ 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 7 0 0 0 2 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMclass_walking = [   0  2  0  0  0  0  0  0  0;  0 21  0  0  0  0  0  0  1;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  1];
CMcooking_schoolwork =  [    0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  26   0   0   0   0  15   0;   0   0   2   0   0   0   0   2   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   5   0   0   0   0 405   0;   0   0   0   0   0   0   0   0   0];
CMdriving = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 ; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMexercising = [    0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMmeeting = [  0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 3 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
CMmeeting_research = [   0   0   0   0   0   1   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  43 547   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
CMnull = [  27  5  0  1  0  0  3  0  0;  0 17  0  0  7  3 10  7  0;  0  0  0  0  0  0  0  0  0;  1  1  0  6  2  0  5  0  1;  0  0  0  0  3  0  2  0  0;  0  8  1  0  2  7  8  4  1;  0  1  2  0  0  0 10  3  0;  0  0  0  0  0  0  0  0  0;  0  2  0  2  1  0  0  0 12];
CMtotalContextSingle = CMclass+CMclass_meeting+CMclass_walking+CMcooking_schoolwork+CMdriving+CMexercising+CMmeeting+CMmeeting_research+CMnull
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMtotalContextSingle)
SingleBeaconResults = {acc, wacc, acc_per, f1, wf1, f1_per};


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% getting test results for paper
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%results for beacons as features (gamma = 0.001, cost = 0.5)
CMbeaconFeatures = [  27   4   0   0   0   0   3   0   8;   18 220   0 102   0   21   12   0  15;   0   0  29   0   0   0   0   12   0;   0   0   3  17   3   0   0   0   6;   2   0   0   8 264   0   0   0   3;   3   1   5  30   1   0   0   0   3;   8   6   0   7   0   47 531   0   7;   0   0   38   0   0   0   0 372   0;   0   4   0   3   0   0   0   0  13];
CMbeaconFeaturesAndStats = [  31   0   0   0   0   0   2   0   9;   4 258   0 101   0  12   0   0  13;   0   0  36   0   0   0   0   5   0;   0   0   3  20   0   0   0   0   6;   2   0   0   4 268   0   0   0   3;   0   0   0  33   0   9   0   0   1;   5   0   0   4   0   3 589   0   5;   0   0   6   0   0   0   0 404   0;   0   1   0   1   0   0   0   0  18];
CMbeacons  = [  11   8   0  11   0   0   6   0   6;   22 313   0   2   0   33   1   0   17;   0   0   0   0   0   0   0  41   0;   0   5   0  13   6   0   0   5   0;   0   0   0   10 267   0   0   0   0;   1  12   0  16   0  14   0   0   0;   19   9   0   2   0  137 416   0  23;   0   0   117   21   0   0   0 272   0;   4   7   0   1   0   1   1   4   2];


%% Single beacon probability, 1/numADL
bc = [  0  1  0  0  0  0  0  0  0;  0 24  0  0  0  0  0  0  0; 0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
c = [   0   1   0   0   0   0   0   0  0;   0 151   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
cm = [ 0 0 0 0 0 0 0 0 0; 0 7 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 5 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cmw = [ 0 1 0 0 0 0 0 0 0; 0 9 0 0 0 6 0 0 0; 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cw = [   0   1   0   0   0   0   0   0   0;   0 169   0   0   0   0   0   0   3;  0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 271   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   1   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  16 504   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 28  3  1  0  1  1  3  0  0;  0 11  0  0  3  0  5  0  0;  0  0  0  0  0  0  0  0  0;  1  0  0 17  1  0  1  0  3;  0  0  0  0  4  0  2  0  0;  1  3  0  1  0 24  6  1  1;  0  6  0  0  0  7 61 10  0;  0  0  0  0  0  0  0  0  0;  0  2  0  1  1  0  0  0 13];
CMsingle = bc+c+cm+cmw+cw+cs+e+mr+n;
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMsingle)
SingleBeaconResults = {acc, wacc, acc_per, f1, wf1, f1_per};


%% Greedy search no bagging
bc = [  0  0  0  0  0  0  0  0  0;  0 20  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
c = [   0   0   0   0   0   0   0   0   0;   0 154   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   2   0   0   0   0   0   0   0];
cm = [  0  0  0  0  0  0  0  0  0;  0 11  0  0  0  1  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  4  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cmw = [  0  0  0  0  0  0  0  0  0;  0 16  0  0  0  6  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   0   0   0   0   0   0   0   0;   0 141   0   0   0   0   0   0   1;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 271   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   0   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 566   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 28  5  0  1  0  2  3  0  1;  0 21  0  0  5  0 10  0  2;  0  0  0  0  0  0  0  0  0;  1  0  0 17  1  0  1  0  3;  0  0  0  0  4  0  2  0  0;  1  4  0  1  0 27  4  1  1;  0  4  0  0  0  2 13  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  1  1  0  0  0 14];
CMGreedyNB = bc+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMGreedyNB)

%% Greedy with bagging
b = [ 11  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  1  0  0  0  0  0  0  0  0];
bc = [  0  1  0  0  0  0  0  0  0;  0 21  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
c = [   0   1   0   0   0   0   0   0   0 ;   0 158   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0]; 
cm = [ 0 0 0 0 0 0 0 0 0; 0 4 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 5 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cw = [   0   1   0   0   0   0   0   0   0;   0 169   0   0   0   0   0   0   3;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   4   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
d = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 8 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
de = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 4 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   1 270   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   0   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 568   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 17  4  0  0  0  1  3  0  1;  0 14  0  0  3  0 14  2  0;  0  0  0  0  0  0  0  0  0;  1  0  0  9  1  0  1  0  3;  0  0  0  0  0  0  2  0  0;  1  2  0  1  0 24  6  1  1;  0  2  0  0  0  2 11  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  1  1  0  0  0 12];
CMGreedyB = b+bc+c+cm+cw+cs+d+de+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMGreedyB)

%% HAC patterns
bc = [  0  1  0  0  0  0  0  0  0;  0 21  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
c = [   0   1   0   0   0   0   0   0  0;   0 155   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
cm =  [ 0  0  0  0  0  0  0  0  0;  0 23  0  0  0  2  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  5  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
cmw =  [ 0  1  0  0  0  0  0  0  0;  0 22  0  0  0  7  0  0  0;  0  0  0  0  0  0  0  0  0; 0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   0   0   0   0   0   0   0   0;   0 119   0   0   0   0   0   0   1;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   1   0   0   0   0   2   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 269   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [ 0   0   0   0   0   1   2   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  21 551   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 28  3  0  0  0  2  3  0  0;  0 18  0  2  8  0  9  0  1;  0  0  0  0  0  0  0  0  0;  1  1  0 17  2  0  1  0  3;  0  0  0  0  6  0  2  0  0;  1  3  0  1  0 24  6  1  1;  0  6  0  0  0  2 22  4  0;  0  0  0  0  0  0  0  0  0;  0  3  0  1  1  0  0  0 13];
CMhac = bc+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMhac)


%%%%%%%%%%%%%
%% Improvements to HAC
%%%%%%%%%%%%%

%% HAC Naive
bse = [ 0 0 0 0 0 0 0 0 0; 1 9 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0];
c =  [ 0  0  0  0  0  0  0  0  0;  0 22  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
ce = [   0   0   0   0   1   0   0   0   0;   0 162   0   0  12   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   5   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0];
cme = [  0  0  0  0  0  0  0  0  0;  0 13  0  0  1  4  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  3  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
cemw = [  0  0  0  0  0  0  0  0  0;  0 36  0  0  2  4  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cew = [  0  1  0  0  0  0  0  0  0;  0 49  0  0  5  0  0  0  2;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0];
cdes = [ 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 4 2 1 0 0 4 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
ces = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  13   0   4   0   0   8   0;   0   0   0   0   2   0   0   1   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  10   0  12   0   0 317   0;   0   0   0   0   0   0   0   0   0];
cs = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  2  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  2  0  0  0  0 63  0;  0  0  0  0  0  0  0  0  0];
de = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   4   0   0   0   0;   0   0   0   0 128   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0  15   0   0   0   0;   0   0   0   0  19   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0  13   0   0   0   0;   0   0   0   0 147   0   0   0   0;   0   0   0   0  24   0   0   0   0;   0   0   0   0   4   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   4   0   0   0   0];
emr = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   6  17 359   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
er = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  2  0 60  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
mr = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0 64  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
n = [ 11  5  1  0  0  0  4  1  3;  1 30  0  1  5  0  5  4  0;  0  0  1  1  0  0  0  1  0;  1  2  0  1  1  0  2  1  1;  0  0  0  0  1  0  0  0  1;  0  2  0  0  0  5  2  0  0;  1  3  0  0  0 11 68 11  0;  0  0  0  0  0  0  5  1  0;  0  0  0  0  0  0  0  0  9];
sc1HACv2 = bse+c+ce+cme+cemw+cew+cdes+ces+cs+de+e+emr+er+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HACv2)

%% HAC Pr
bs = [  0  1  0  0  0  0  0  0  0;  1 21  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmrw = [  0  0  0  0  0  0  1  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  1 12  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;]
bmsw = [  7  0  0  0  0  2  0  4  2;  6  0  0  0  0  3  0  5  5;  0  0  0  0  0  0  0  0  0;  3  0  0  0  0  1  0  7  2;  1  0  0  0  0  0  0  4  0;  0  0  0  0  0 18  0  3  3;  0  0  0  0  0  3  0  1  0;  0  0  0  0  0  0  0  0  0;  1  0  0  0  0  0  0  2  1];
c = [   0   0   0   0   0   0   0   0   0;   0 152   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
cm = [  0  0  0  0  0  0  0  0  0;  0 11  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  4  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cmw = [  0  1  0  0  0  0  0  0  0;  0  6  0  0  0 11  0  0  1;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   0   0   0   0   0   0   0   0;   0 157   0   0   0   0   0   0   3;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   2   0   0   0   0   1   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0 381   0;   0   0   0   0   0   0   0   0   0];
e= [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr =   [ 0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  24 498   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n= [ 12  4  1  0  0  0  3  1  3;  1  1  0  1  2  0  1  0  0;  0  0  0  0  0  0  0  0  0;  2  2  0  3  1  0  2  1  1;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  9  2  0  0;  1  2  1  0  0  6 45 11  0;  0  1  0  0  0  0  5  6  0;  0  0  0  0  0  0  0  0 10];
sc1HACv2 = bs+bmrw+bmsw+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HACv2)


%% Naive HAC, removed FP threshold
most = [  14  10   0   0   2   0   6   0   1;   6 230   1   5  24   6  23  25   3;   0   1  15   3   4   0   3  10   0;   3   4   0   6   4   0   6   2   1;   0  14   0   0 211   0   3   2   2;   0   5   1   0   0  20  10   0   0;   2   6   2   1   4  22 443  30   1;   0  41   6   6   1   2  75 211   2;   0   3   0   0   0   0   0   2  10];
c = [  0  0  0  0  0  0  0  0  0;  0 21  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cds = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  1  1  0  0  0  3  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  2  1  0  0  0 62  0;  0  0  0  0  0  0  0  0  0];
de = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  1 39  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
mr = [  0  0  0  0  0  0  1  0  0; 0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  3 70  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
n = [  2  1  1  0  0  0  0  1  3;  1 29  0  1  4  0  5  4  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  1  1  0;  0  0  0  0  5  0  0  0  0;  0  1  0  0  0  4  1  0  0;  0  1  0  0  0  5 15  1  0;  0  0  0  0  0  0  0  1  0;  0  0  0  0  0  0  0  0  2];
sc1HAC_t = most+c+cds+de+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HAC_t)


%% pr, removed FP thresh
bc = [  0  1  0  0  0  0  0  0  0;  1 21  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmsw = [  7  0  0  0  0  2  0  4  2;  4  0  0  0  0  3  0  5  5;  0  0  0  0  0  0  0  0  0;  3  0  0  0  0  1  0  6  2;  1  0  0  0  0  0  0  4  0;  0  0  0  0  0 18  0  3  3;  0  0  0  0  0  3  0  1  0;  0  0  0  0  0  0  0  0  0;  1  0  0  0  0  0  0  2  1];
c = [   0   0   0   0   0   0   0   0   0;   0 148   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
cm = [ 0 0 0 0 0 0 0 0 0; 0 9 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 4 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cmw = [  0  1  0  0  0  0  0  0  0;  0  5  0  0  0 11  0  0  1;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   0   0   0   0   0   0   0   0;   0 166   0   0   0   0   0   0   3;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   2   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0 393   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  24 500   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 12  4  1  0  0  0  4  1  3;  1  1  0  1  2  0  1  0  0;  0  0  0  0  0  0  0  0  0;  2  2  0  3  1  0  2  1  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  9  2  0  0;  1  2  0  0  0  7 56 11  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0 10];
sc1HAC_t = bc+bmsw+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HAC_t)


%% naive, lower IOU (and no fp thresh)
all = [  14  10   0   0   2   0   6   0   1;   6 229   1   5  25   6  23  25   3;   0   1  15   3   4   0   3  10   0;   3   4   0   6   4   0   6   2   1;   0  14   0   0 211   0   3   2   2;   0   5   1   0   0  20  10   0   0;   2   6   2   1   4  22 443  30   1;   0  41   6   6   1   2  75 211   2;   0   3   0   0   0   0   0   2  10];
c = [  0  0  0  0  0  0  0  0  0;  0 27  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cs = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  1  1  0  0  0  3  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  2  1  0  0  0 63  0;  0  0  0  0  0  0  0  0  0];
de = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  1 30  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
mrw = [  0  0  0  0  0  0  1  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  3 71  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
n = [  2  1  1  0  0  0  0  1  3;  1 23  0  1  4  0  5  4  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  1  1  0;  0  1  0  0 13  0  0  0  0;  0  1  0  0  0  4  1  0  0;  0  1  0  0  0  5 14  1  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  2];
sc1HAC_i = all+c+cs+de+mrw+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HAC_i)

%% pr, lower IOU (no fp thresh)
bc = [  0  0  0  0  0  0  0  0  0;  0 20  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmr = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0 16  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmrw = [  0  0  0  0  0  0  1  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  1 10  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmsw = [  7  0  0  0  0  2  0  5  2;  6  0  0  0  0  3  0  7  6;  0  0  0  0  0  0  0  0  0;  3  0  0  0  0  1  0  6  2;  1  0  0  0  0  0  0  4  0;  0  0  0  0  0 18  0  3  3;  0  0  0  0  0  3  0  1  0;  0  0  0  0  0  0  0  0  0;  1  0  0  0  0  0  0  2  2];
c = [   0   0   0   0   0   0   0   0   0;   0 158   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
cm = [  0  0  0  0  0  0  0  0  0;  0 12  0  0  0  2  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  4  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cmw = [  0  0  0  0  0  0  0  0  0;  0 11  0  0  0  9  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   0   0   0   0   0   0   0   0;   0 145   0   0   0   0   0   0   3;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   2   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0 393   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 272   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  24 494   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 12  4  1  0  1  0  3  1  3;  1  1  0  1  2  0  1  0  0;  0  0  0  0  0  0  0  0  0;  2  2  0  3  1  0  2  1  0;  0  0  0  0  0  0  0  0  0;  0  2  0  0  0  9  2  0  0;  1  1  0  0  0  6 39  9  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  9];
sc1HAC_i = bc+bmr+bmrw+bmsw+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HAC_i)
%% naive, lower tp threshold
most = [  14  10   0   0   2   0   6   0   1;   6 229   1   5  25   6  23  25   3;   0   1  15   3   4   0   3  10   0;   3   4   0   6   4   0   6   2   1;   0  14   0   0 211   0   3   2   2;   0   5   1   0   0  20  10   0   0;   2   6   2   1   4  22 443  30   1;   0  41   6   6   1   2  75 211   2;   0   3   0   0   0   0   0   2  10];
c= [  0  0  0  0  0  0  0  0 0;  0 27  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cds = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  1  1  0  0  0  3  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  2  1  0  0  0 63  0;  0  0  0  0  0  0  0  0  0];
de = [  0  0  0  0  0  0  0 0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  1 30  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
mrw = [  0  0  0  0  0  0  1  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  3 71  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
n  =[  2  1  1  0  0  0  0  1  3;  1 23  0  1  4  0  5  4  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  1  1  0;  0  1  0  0 13  0  0  0  0;  0  1  0  0  0  4  1  0  0;  0  1  0  0  0  5 14  1  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  2];
sc1HAC_tp = most+c+cds+de+mrw+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1HAC_tp)


%% Redo single beacon sc1
%%Single beacons, naive
many = [  14  10   0   0   2   0   6   0   1;   6 229   1   5  25   6  23  25   3;   0   1  15   3   4   0   3  10   0;   3   4   0   6   4   0   6   2   1;   0  14   0   0 211   0   3   2   2;   0   5   1   0   0  20  10   0   0;   2   6   2   1   4  22 443  30   1;   0  41   6   6   1   2  75 211   2;   0   3   0   0   0   0   0   2  10];
bmrw = [ 0 0 0 0 0 0 1 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 3 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cw = [  0  0  0  0  0  0  0  0  0;  0 30  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cds = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  1  1  0  0  0  3  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  2  1  0  0  0 63  0;  0  0  0  0  0  0  0  0  0];
de = [  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  1 42  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
mrw = [  0  0  0  0  0  0  1  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  7 83  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
n = [  2  0  1  0  0  0  0  1  3;  1 18  0  1  3  1  7  4  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  1  1  0;  0  1  0  0  1  0  0  0  0;  0  2  0  0  0  4  1  0  0;  0  0  0  0  0  1  0  1  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  2];
sc1N = many+bmrw+cw+cds+de+mrw+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1N)

%% single beacon, pr estimate
bc = [  0  1  0  0  0  0  0  0  0;  1 23  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
bmsw = [  5  0  0  0  0  2  0  3  2;  4  0  0  0  0  3  0  3  3;  0  0  0  0  0  0  0  0  0;  3  0  0  0  0  1  0  5  2;  1  0  0  0  0  0  0  1  0;  0  0  0  0  0 18  0  3  3;  0  0  0  0  0  3  0  1  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  2  0];
c = [   0   1   0   0   0   0   0   0   0;   0 151   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   0];
cm = [ 0 0 0 0 0 0 0 0 0; 0 7 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 2 0 0 0 4 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0];
cmw = [  0  1  0  0  0  0  0  0  0;  0  4  0  0  0 10  0  0  1;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
cw = [   0   1   0   0   0   0   0   0   0;   0 169   0   0   0   0   0   0   3;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   2   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   1   0   0   0   0   0   0   1];
cs = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  19   0   0   0   0  22   0;   0   0   2   0   0   0   0   3   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  17   0   0   0   0 393   0;   0   0   0   0   0   0   0   0   0];
e = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   1   0   0   0   0;   0   0   0   0 271   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
mr = [   0   0   0   0   0   0   1   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  24 496   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 12  3  1  0  0  0  5  1  3;  1  1  0  1  2  0  1  0  0;  0  0  0  0  0  0  0  0  0;  2  2  0  3  1  0  3  1  0;  0  0  0  0  3  0  1  0  0;  0  2  0  0  0  9  2  0  0;  1  3  0  0  0  7 58 11  0;  0  0  0  0  0  0  0  0  0;  0  1  0  0  0  0  0  0 11];
sc1Pr = bc+bmsw+c+cm+cmw+cw+cs+e+mr+n
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(sc1Pr)

%%%%%%%%%%%%%%%
% locations as labels
%%%%%%%%%%%%%%%

%% exact training set
ce1 = [  0  0  0  0  0  0  0  0  0;  0 14  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0];
ce2 = zeros(9); ce2(2,2) = 71;
cw = zeros(9); cw(2,2) = 141;
cz1 = zeros(9); cz1(2,2) = 87;
cz2 = zeros(9); cz2(2,2) = 75;
gym = zeros(9); gym(5,5) = 277;
home =   [ 0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
lab = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  13 593   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [  34  0  0  3  0  0  0  0  5;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  2  0  0 23  0  0  0  0  4;  0  0  0  0  0  0  0  0  0; 10  0  0 11  0  0  0  0  4;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  4  0  0  0  0 16];
sem = zeros(9); sem(6,6) = 18;
CMlocation = ce1+ce2+cw+cz1+cz2+gym+home+lab+n+sem
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMlocation)

%% training set split based on appropriate label only
ce1 = zeros(9); ce1(2,2)=14;
ce2 = zeros(9); ce2(2,2)=71;
ce2 = zeros(9); ce2(2,2) = 71;
cw = zeros(9); cw(2,2) = 141;
cz1 = zeros(9); cz1(2,2) = 87;
cz2 = zeros(9); cz2(2,2) = 75;
gym = zeros(9); gym(5,5) = 277;
home = [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0  25   0   0   0   0  16   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   6   0   0   0   0 404   0;   0   0   0   0   0   0   0   0   0];
lab= [   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0  25 581   0   0;   0   0   0   0   0   0   0   0   0;   0   0   0   0   0   0   0   0   0];
n = [ 34  0  0  3  0  0  0  0  5;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  2  0  0 23  0  0  0  0  4;  0  0  0  0  0  0  0  0  0; 10  0  0 11  0  0  0  0  4;  0  0  0  0  0  0  0  0  0;  0  0  0  0  0  0  0  0  0;  0  0  0  4  0  0  0  0 16];
sem = zeros(9); sem(6,6) = 18;
CMlocation = ce1+ce2+cw+cz1+cz2+gym+home+lab+n+sem
[acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(CMlocation)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% calculate statistics for the confusion matrix cm
function [acc, wacc, acc_per, f1, wf1, f1_per] = cmStats(cm)

positives = sum(cm,2);
numInstances = sum(positives);

acc_per = zeros(length(cm),1);
for i=1:size(cm,2)
    acc_per(i) = cm(i,i)/positives(i);
end
acc = mean(acc_per);
wacc = sum(positives.*acc_per)/numInstances;

f1_per = zeros(size(acc_per));
recall = zeros(length(cm),1); %uses false negative
precision = zeros(size(recall)); %uses false positive
for i=1:size(cm,2)
    precision(i) = cm(i,i) / sum(cm(:,i));
    recall(i) = cm(i,i) / sum(cm(i,:));
    f1_per(i) = harmmean([precision(i), recall(i)]);
end

f1 = mean(f1_per);
wf1 = sum(positives.*f1_per)/numInstances;

end

